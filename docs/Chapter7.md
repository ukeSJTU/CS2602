# 第 7 章 排序

- [第 7 章 排序](#第-7-章-排序)
  - [7.1 引言](#71-引言)
  - [7.2 冒泡排序](#72-冒泡排序)
  - [7.3 插入排序](#73-插入排序)
    - [7.3.1 简单插入排序](#731-简单插入排序)
    - [7.3.2 折半插入排序](#732-折半插入排序)
    - [7.3.3 希尔排序](#733-希尔排序)
  - [7.4 归并排序](#74-归并排序)
  - [7.5 快速排序](#75-快速排序)
  - [7.6 选择排序和堆排序](#76-选择排序和堆排序)
    - [7.6.1 选择排序](#761-选择排序)
    - [7.6.2 堆排序](#762-堆排序)
    - [7.6.3 堆和优先队列](#763-堆和优先队列)
  - [7.7 基数排序](#77-基数排序)
    - [7.7.1 多关键字排序](#771-多关键字排序)
    - [7.7.2 基数排序法](#772-基数排序法)
  - [7.8 内部排序算法的比较](#78-内部排序算法的比较)
  - [7.9 外部排序](#79-外部排序)
    - [7.9.1 外部排序的处理过程](#791-外部排序的处理过程)
    - [7.9.2 K 路归并](#792-k-路归并)
    - [7.9.3 初始归并段](#793-初始归并段)
    - [7.9.4 最佳归并树](#794-最佳归并树)
  - [7.10 小结](#710-小结)
  - [7.11 习题](#711-习题)
    - [书本](#书本)
      - [问题 1](#问题-1)
      - [问题 2](#问题-2)
      - [问题 3](#问题-3)
      - [问题 4](#问题-4)
      - [问题 5](#问题-5)
      - [问题 6`**`](#问题-6)
      - [问题 7](#问题-7)
      - [问题 8](#问题-8)
      - [问题 9](#问题-9)
      - [问题 10](#问题-10)
      - [问题 11](#问题-11)
      - [问题 12](#问题-12)
      - [问题 13](#问题-13)
    - [PPT](#ppt)
    - [ACM-OJ](#acm-oj)

## 7.1 引言

- 排序的定义：将一组记录按关键字值的大小重新排列成有序序列
- 排序的稳定性：相同关键字的记录在排序前后的相对位置不变
- 内部排序：待排序记录全部存放在内存中进行排序
- 外部排序：待排序记录的数量很大，部分存放在外存中

## 7.2 冒泡排序

- 基本思想：相邻元素两两比较，逆序则交换
- 时间复杂度：O(n²)
- 空间复杂度：O(1)
- 稳定性：稳定
- 优化方案：设置标志位，某趟排序没有发生交换则提前结束

## 7.3 插入排序

### 7.3.1 简单插入排序

- 基本思想：将待排序记录插入到已排好序的有序表中
- 时间复杂度：O(n²)
- 空间复杂度：O(1)
- 稳定性：稳定
- 特点：对基本有序的序列效率较高

### 7.3.2 折半插入排序

- 改进：在查找插入位置时采用折半查找
- 时间复杂度：O(n²)（比较次数减少，但移动次数不变）
- 空间复杂度：O(1)
- 稳定性：稳定

### 7.3.3 希尔排序

- 基本思想：缩小增量排序，分组插入排序
- 时间复杂度：O(n^1.3)（最好情况）
- 空间复杂度：O(1)
- 稳定性：不稳定
- 特点：对大规模乱序数组效率较高

## 7.4 归并排序

- 基本思想：分治法，将两个有序表合并成一个有序表
- 时间复杂度：O(nlogn)
- 空间复杂度：O(n)
- 稳定性：稳定
- 特点：适合外部排序

## 7.5 快速排序

- 基本思想：选择基准元素，划分区间，递归排序
- 时间复杂度：平均 O(nlogn)，最坏 O(n²)
- 空间复杂度：O(logn)
- 稳定性：不稳定
- 优化：三数取中法选择基准，小区间使用插入排序

## 7.6 选择排序和堆排序

### 7.6.1 选择排序

- 基本思想：每次从待排序序列中选择最小元素
- 时间复杂度：O(n²)
- 空间复杂度：O(1)
- 稳定性：不稳定

### 7.6.2 堆排序

- 基本思想：利用堆的性质进行选择排序
- 时间复杂度：O(nlogn)
- 空间复杂度：O(1)
- 稳定性：不稳定
- 关键操作：建堆和调整堆

### 7.6.3 堆和优先队列

- 堆的定义：完全二叉树，满足堆序性
- 优先队列：用堆实现的队列，每次出队为最值元素
- 应用：任务调度、事件模拟

## 7.7 基数排序

### 7.7.1 多关键字排序

- 基本思想：按关键字优先级逐个进行排序
- MSD：从高位到低位排序
- LSD：从低位到高位排序

### 7.7.2 基数排序法

- 基本思想：按位排序，利用计数排序
- 时间复杂度：O(d(n+r))，d 为位数，r 为基数
- 空间复杂度：O(r)
- 稳定性：稳定
- 特点：适用于数据范围较小的整数排序

## 7.8 内部排序算法的比较

- 时间效率比较：
  - O(n²)：冒泡、选择、插入
  - O(nlogn)：快速、归并、堆
  - O(n)：基数（特定条件下）
- 空间效率比较：
  - O(1)：冒泡、选择、插入、堆
  - O(logn)：快速
  - O(n)：归并
- 稳定性比较：
  - 稳定：冒泡、插入、归并、基数
  - 不稳定：选择、快速、堆、希尔

## 7.9 外部排序

### 7.9.1 外部排序的处理过程

- 预处理：内部排序形成初始归并段
- 归并排序：多路归并
- 内存管理：缓冲区管理

### 7.9.2 K 路归并

- 基本思想：同时归并 K 个有序段
- 选择方法：败者树、最小堆
- 时间复杂度：O(nlogk)

### 7.9.3 初始归并段

- 生成方法：内部排序
- 置换选择排序：生成长度大于内存的初始归并段

### 7.9.4 最佳归并树

- 哈夫曼树思想：构造最优归并方案
- 目标：最小化总的归并代价

## 7.10 小结

- 排序算法的选择依据：
  1. 数据规模
  2. 数据分布特征
  3. 空间限制
  4. 稳定性要求
- 实际应用中的建议：
  1. 小规模数据：插入排序
  2. 大规模随机数据：快速排序
  3. 外部排序：归并排序
  4. 空间紧张：堆排序
  5. 整数排序：基数排序

## 7.11 习题

### 书本

#### 问题 1

简述什么是内排序、外排序、稳定排序、不稳定排序？

<details>
  <summary>答案</summary>

如果待排序的全部数据可以一次性加载到内存上就是**内排序**，反之是外排序。

如果一组元素的关键字值相同，且它们的相对位置在排序前后保持不变则是**稳定排序**，反之为不稳定排序。

</details>

#### 问题 2

已知内存中的一个数据序列为 20、4、12、8、23、5、10、45、15，试用冒泡排序、插入排序、选择排序、归并排序、快速排序、堆排序、基数排序算法对其排序，需要给出排序的每一步过程。

<details>
  <summary>答案</summary>

如果一组元素的关键字值相同，且它们的相对位置在排序前后保持不变则是稳定排序，反之为不稳定排序。

</details>

#### 问题 3

如果外存上的原始数据序列为 20、4、12、8、23、5、10、45、15，内存一次只能存储 3 个元素，利用置换选择法给出所有的初始归并段。

<details>
  <summary>答案</summary>

如果一组元素的关键字值相同，且它们的相对位置在排序前后保持不变则是稳定排序，反之为不稳定排序。

</details>

#### 问题 4

假设在排序中有 3 条磁带可用，试对上题获得的初始归并段进行 2 路归并。要求写出归并的过程。

#### 问题 5

写出实现折半插入排序算法的程序。

#### 问题 6`**`

设计两个算法实现在一组 n 个元素组成的无序序列中，找到第 k 大的元素。要求时间复杂度分别为`O(n+klog2n)`和`O(nlog2n)`.

#### 问题 7

对图 7-25 进行改造，使内存中存储的数据成为一个最小化堆结构。

#### 问题 8

请给出一组元素 (18,23,47,13,5,27,54)通过逐一插入法建立大顶堆的执行过程，即写出注意插入过程中堆的层次遍历序列。

#### 问题 9

对给定的关键字序列 110，119007，911，114，120，122 进行基数排序，则第 2 躺分配收集后得到的关键字序列是：

1. 007, 110, 119, 114, 911, 120,122
2. 007, 110, 119, 114, 911, 122, 120
3. 007, 1110, 911, 114, 119, 120, 122
4. 110, 120, 911, 122, 114, 007, 119

#### 问题 10

对 10TB 的数据文件进行排序，应使用的方法是：

1. 希尔排序
2. 堆排序
3. 快速排序
4. 归并排序

#### 问题 11

下列排序算法中，元素的移动次数与关键字的初始排序次序无关的是：

1. 直接插入排序
2. 冒泡排序
3. 基数排序
4. 快速排序

#### 问题 12

已知小顶堆为 8，15， 10， 21， 34， 16， 12， 删除关键字 8 之后需要重建堆，在此过程中，关键字之间的比较次数是：

1. 1
2. 2
3. 3
4. 4

#### 问题 13

希尔排序的组内排序采用的是：

1. 直接插入排序
2. 折半插入排序
3. 快速排序
4. 归并排序

### PPT

### ACM-OJ
